#!/bin/bash

DB="$1"
SVR="$2"
USAGE="Usage: $0 dbname [server]"
if [ -z "$DB" ]; then
	echo $USAGE;
	exit 1;
fi
#if [ -z "$SVR" ]; then
#	SVR="server.domain.com"
#fi;
if [ -z "$SVR" ]; then
	echo "servername required (you can edit the script to fix this)";
	echo $USAGE;
	exit 1;
fi;

echo " # ---> IMPORTANT! This script will attempt to create the database locally (ignore errors about that)";
echo "create schema ${DB}" | mysql -u root

CMD="ssh ${SVR} \"mysqldump -u root -R ${DB}\" | mysql -u root ${DB}"
echo " # ---> going to run the following command:";
echo " ${CMD}"
read -p " ## press [enter] to continue...";
echo " # ---> HERE I GO!"

ssh ${SVR} "mysqldump -u root -R ${DB}" | mysql -u root ${DB}

echo " # ---> Done."
